bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 20)
#STEP6
tfidf_sentiment_summary <- tfidf_sentiment %>%
group_by(doc_title, sentiment) %>%
summarise(total_tfidf = sum(tf_idf), .groups = "drop") %>%
pivot_wider(names_from = sentiment, values_from = total_tfidf, values_fill = 0) %>%
mutate(net_tfidf_sentiment = positive - negative)
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 20)
#STEP6
tfidf_sentiment_summary <- tfidf_sentiment %>%
group_by(doc_title, sentiment) %>%
summarise(total_tfidf = sum(tf_idf), .groups = "drop") %>%
pivot_wider(names_from = sentiment, values_from = total_tfidf, values_fill = 0) %>%
mutate(net_tfidf_sentiment = positive - negative)
tfidf_sentiment_summary
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% arrange(desc(tf_idf)) %>% print(n = 5)
tfidf_sentiment %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% arrange(desc(tf_idf)) %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
group_by(doc_title) %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n = 5)
group_by(doc_title) %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 5)
df2 <- tfidf_words %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
tfidf_words
df2 <- tfidf_words %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
tfidf_words
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
select(doc_title, word, sentiment, tfidf_words) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tfids_words), .by_group = TRUE)  %>%
slice_head(n=20)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
bing <- get_sentiments("bing")
select(doc_title, word, sentiment, tfidf_words) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tfids_words), .by_group = TRUE)  %>%
slice_head(n=20)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
tfidf_sentiment <- tfidf_words %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
tfidf_sentiment %>% count(sentiment)
tfidf_sentiment %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP6
tfidf_sentiment_summary <- tfidf_sentiment %>%
group_by(doc_title, sentiment) %>%
summarise(total_tfidf = sum(tf_idf), .groups = "drop") %>%
pivot_wider(names_from = sentiment, values_from = total_tfidf, values_fill = 0) %>%
mutate(net_tfidf_sentiment = positive - negative)
tfidf_sentiment_summary
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(tidytext)
#STEP1
file_a <- "texts/A07594__Circle_of_Commerce.txt"
file_b <- "texts/B14801__Free_Trade.txt"
text_a <- read_file(file_a)
text_b <- read_file(file_b)
texts <- tibble(
doc_title = c("Text A", "Text B"),
text = c(text_a, text_b)
)
#Stopwords
data("stop_words")
custom_stopwords <- tibble(
word = c("vnto", "haue", "doo", "hath", "bee", "ye", "thee")
)
all_stopwords <- bind_rows(stop_words, custom_stopwords) %>%
distinct(word)
tidy_tokens <- texts %>%
unnest_tokens(word, text) %>%
anti_join(all_stopwords, by = "word")
tidy_tokens
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment
#STEP3
doc_sentiment_summary <- tokens_with_sentiment %>%
count(doc_title, sentiment) %>%
pivot_wider(
names_from = sentiment,
values_from = n,
values_fill = 0
) %>%
mutate(net_sentiment = positive - negative)
doc_sentiment_summary
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 5)
#STEP5
bing <- get_sentiments("bing")
tfidf_sentiment <- tfidf_words %>%
inner_join(bing, by = "word")
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=20)
df2
#STEP6
tfidf_sentiment_summary <- tfidf_sentiment %>%
group_by(doc_title, sentiment) %>%
summarise(total_tfidf = sum(tf_idf), .groups = "drop") %>%
pivot_wider(names_from = sentiment, values_from = total_tfidf, values_fill = 0) %>%
mutate(net_tfidf_sentiment = positive - negative)
tfidf_sentiment_summary
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
group_by(doc_title, sentiment) %>%
arrange(desc(word), .by_group = TRUE)  %>%
slice_head(n=20)
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment %>%
count(doc_title, word, sentiment) %>%
group_by(doc_title) %>%
arrange(desc(n), .by_group = TRUE) %>%
slice_head(n = 10)
tokens_with_sentiment
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment %>%
count(doc_title, word, sentiment) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(n), .by_group = TRUE) %>%
slice_head(n = 20)
tokens_with_sentiment
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment %>%
count(doc_title, word, sentiment) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(n), .by_group = TRUE) %>%
slice_head(n = 5)
tokens_with_sentiment
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment %>%
count(doc_title, word, sentiment) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(n), .by_group = TRUE) %>%
slice_head(n = 20)
tokens_with_sentiment
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 20)
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
#STEP4
#words per doc after stopremoval
word_counts <- tidy_tokens %>%
count(doc_title, word)
#TF-IDF counts
tfidf_words <- word_counts %>%
bind_tf_idf(term = word, document = doc_title, n = n)
tfidf_words %>% arrange(desc(tf_idf)) %>% print(n = 5)
#STEP2
bing <- get_sentiments("bing")
tokens_with_sentiment <- tidy_tokens %>%
inner_join(bing, by = "word")
tokens_with_sentiment %>%
count(doc_title, word, sentiment) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(n), .by_group = TRUE) %>%
slice_head(n = 5)
tokens_with_sentiment
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
df2 <- tfidf_sentiment %>%
select(doc_title, word, sentiment, tf_idf) %>%
group_by(doc_title, sentiment) %>%
arrange(desc(tf_idf), .by_group = TRUE)  %>%
slice_head(n=5)
df2
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
readr::write_csv(final_sentiment_comparison, "final_sentiment_comparison.csv")
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
readr::write_csv(final_sentiment_comparison, "final_sentiment_comparison.csv")
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
readr::write_csv(final_sentiment_comparison, "final_sentiment_comparison.csv")
#FINAL STEP
final_sentiment_comparison <- doc_sentiment_summary %>%
rename(
raw_positive = positive,
raw_negative = negative,
raw_net_sentiment = net_sentiment
) %>%
inner_join(
tfidf_sentiment_summary %>%
rename(
tfidf_positive = positive,
tfidf_negative = negative
),
by = "doc_title"
)
final_sentiment_comparison
readr::write_csv(
final_sentiment_comparison,
"~/Downloads/final_sentiment_comparison.csv"
)
